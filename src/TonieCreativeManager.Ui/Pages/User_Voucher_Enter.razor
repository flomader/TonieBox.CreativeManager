@page "/user/voucher/enter"
@page "/user/voucher/enter/{value}"

@inject Settings Settings

@inject VoucherService VoucherService

@inject IHttpContextAccessor Accessor

<Header></Header>

<div class="enterbox" style="margin-top:2rem;margin-bottom:4rem;">
    &nbsp;@Value&nbsp;
</div>

<div class="keyboard">

    @foreach (var key in Settings.KeyboardCharacters)
    {
        <a href="/user/voucher/enter/@(Value + key)">@key</a>
    }

</div>

@code {

    [Parameter] public string Value { get; set; }

    protected override async Task OnInitializedAsync()
    {
        if (await VoucherService.IsValid(Value))
        {
            Accessor.HttpContext.Response.Redirect($"/user/voucher/redeem/{Value}");
        }
    }

}