@page "/upload/selecttonie"

@inject CreativeTonieService CreativeTonieService

@inject IHttpContextAccessor HttpContext

<a class="back mb-3" href="@backUrl">Zurück</a>

<Grid Items="items" RestrictItemWidth="true"></Grid>

@code {

    IEnumerable<GridItem> items;

    string backUrl;

    protected override async Task OnInitializedAsync()
    {
        var path = HttpContext.HttpContext.Request.Query["path"].ToString();

        backUrl = $"/browse?path={path.GetParentPath().EncodeUrl()}";

        var tonies = await CreativeTonieService.GetTonies();

        items = tonies
            .Select(t => new GridItem
            {
                ImageUrl = t.ImageUrl,
                Name = t.Name,
                Url = $"/upload/start/{t.Id}?path={path.EncodeUrl()}",
                SubImageUrl = t.CurrentMediaPath != null ? $"/cover?path={t.CurrentMediaPath.EncodeUrl()}" : null
            })
            .ToArray();
    }

}